# 🐍 Python案件収集・分析ダッシュボード

本プロジェクトは、複数のフリーランス案件サイトからスクレイピングされたPython関連案件データを自動で集計・分析し、Googleスプレッドシート上で可視化するシステムです。

---

## 📊 システム概要

各案件サイト（スプレッドシート）から本日分のデータを自動抽出し、中央値の算出やスキルごとの需要動向を分析します。分析結果は時系列で蓄積され、ダッシュボード上で直近の市場トレンドを確認することが可能です。

---

## ✨ 主な機能

- **自動データ集計**: 複数ソースから本日分データのみを判別して一括取得
- **動的スキルマッピング**: 新規出現スキルを自動検知し、集計表へ列を自動追加
- **時系列分析**: 「直近1週間」「直近1ヶ月」「直近1年」の切り口で推移を可視化
- **実行ログ・異常検知**: 取得成否をログシートに記録し、更新未検知時はChatWorkへ通知

---

## ⚙️ セットアップ手順

### ① 設定シートの入力

「設定」シートに以下の情報を入力してください。

| 項目 | 説明 |
|------|------|
| **サイト名** | 識別用の名称（サイトA、サイトB等） |
| **スプレッドシートID** | 取得元となるスプレッドシートのID |
| **ChatWork設定** | APIトークンおよびルームID（通知用） |

### ② 実行トリガーの設定

Google Apps Scriptのエディタ左側「**トリガー（時計アイコン）**」より、以下の設定を推奨します。

- **実行する関数**: `runIntegration`（またはメインの実行関数名）
- **イベントのソース**: 時間主導型
- **タイプ**: 日付ベースのタイマー
- **時刻**: 午前2時〜3時（ソース側の更新完了後の時間帯）

---

## 🔧 運用・管理について

### 表記揺れへの対応

「Python」と「PYTHON」などの表記揺れは、原則としてデータソース（スクレイピング側）での統一を推奨します。

### ログの確認

処理の成否は本ファイル内の「**実行ログ**」シートに記録されます。ChatWorkに通知が飛んだ場合は、対象サイトのデータ（B2セルの日付等）を確認してください。

### データの分析範囲

ダッシュボードのグラフは「**計算用**」シートのQUERY関数によって制御されています。必要に応じて表示期間の調整が可能です。
