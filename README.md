# 🐍 GAS データ集計・ログ管理ダッシュボード

本プロジェクトは、Google Apps Script (GAS) を用いて、外部のスプレッドシートからデータを自動収集・集計し、ダッシュボードでの可視化を支援するシステムです。

---

## 📊 システム概要

「設定」シートに登録された複数のスプレッドシートIDを順番に見に行き、**バッチ実行日と同じ日付のデータ（B2セルで判定）**がある場合に、そのデータをコピーして統合・集計を行います。
処理の成否はログとして記録され、不備がある場合は自動で通知が行われます。

---

## ✨ 主な機能

- **データ自動集計**: 本日分データのみを自動判別して他シートから一括取得。
- **シートクリア機能**: 実行時に「サイト別」シートを一度クリアし、重複を防ぎます。
- **実行ログ管理**: 「実行ログ」シートに、処理の開始・成功・失敗・終了の履歴を自動記録。
- **エラー通知**: データの取得に失敗したサイトがある場合、ChatWorkへ即時にエラー内容を通知。
- **アーカイブ集計**: 統合されたデータを「集計」シートへ時系列で蓄積（中央値や合計件数）。

---

## ⚙️ セットアップ手順

### ① 「設定」シートの入力

「設定」シートに、取得元となるスプレッドシートの情報を入力してください（A2セル以降）。

| 列 | 項目 | 説明 |
|:---:|:---|:---|
| **A** | **サイト名** | 識別用の名称（ログや通知の見出しになります） |
| **B** | **スプレッドシートID** | 取得元のスプレッドシートID |

### ② 通知設定 (Script Properties)

通知機能を利用するには、GASの「設定（歯車アイコン）」＞「スクリプト プロパティ」に以下を追加してください。

- **項目名**: `CHATWORK_API_KEY`
- **値**: あなたのChatWork APIトークン

※ ルームIDは現在 `Notifier.gs` 内で固定（`40851424`）されています。

### ③ 実行トリガーの設定

GASエディタ左側の「トリガー（時計アイコン）」より、以下の設定を推奨します。

- **実行する関数**: `runIntegration`
- **イベントのソース**: 時間主導型
- **タイプ**: 日付ベースのタイマー
- **時刻**: 午前0時〜3時（データソース側の更新が完了している時間帯）

---

## 🔧 運用・管理について

### 処理結果の確認

- **実行ログ**: 「実行ログ」シートを確認してください。「失敗」ログがある場合は、対象サイトのデータ（特にB2セルの日付）が本日分になっているか確認してください。
- **ChatWork通知**: 取得エラーが発生した際のみ通知が飛びます。

### データの取得範囲

- 元シートの **B2セル** の日付が実行当日と一致している列を「本日分」として取得します。
- 抽出する列（案件名、価格、スキル等）は `Main.gs` 内のインデックスに基づいています。
